---
title: "問題解説：rs232c使ったことあります？"
description: "問題解説：rs232c使ったことあります？"
tags: [ICTSC9,ネットワーク関連,問題解説]
pubDate: 2018-03-30T14:44:37
slug: "2018/03/30/問題解説：rs232c使ったことあります？"
draft: false
renderer: "html"
sticky: false
---

<p>どうも、作問者のnasuと言います。</p>
<h1>問題文</h1>
<p>今回ある学校のL2部分をalaxala製のL2SWで構築することになった。<br />
そして回線障害、機器障害が起きても通信を問題なく行えるように、alaxalaの独自プロトコル(リングプロトコル、GSRP)で冗長化をする。<br />
しかし検証環境で設定を入れて、ALA-CとALA-Bを繋いでいるケーブルの障害試験を行なった際に、正常に切り替わることができず検証用のホスト(192.168.19.200/26)へ一切疎通が取れなくなってしまった。<br />
またコンソールにはたくさんのログが流れており、状況がつかめずにいる。<br />
あなたは疎通が取れない原因の報告と、そして障害が起きた状態で疎通が出来るように対処をしてもらいたい。</p>
<h2>制約</h2>
<ul>
<li>ALA-B,ALA-C,2960-B間は必ずgsrpを使った冗長設定、またALA-A,ALA-B,ALA-Cはリングプロトコルを使った冗長設定にしてください。プロトコルを使わないという解答は点数になりません。</li>
</ul>
<h1>トラブルの概要</h1>
<ul>
<li>両方のスイッチのgsrpに<code>no-neighbor-to-master direct-down</code>と設定が入っている為、障害時に両方のスイッチがお互いに障害が発生したと判断してパケットが両方のスイッチでフォワードされるようになり無限ループする構成となってしまった</li>
<li>リングプロトコルのhealth-checkの値が間違っている</li>
</ul>
<h1>解説</h1>
<p>ALA-B,ALA-Cでつながっているインターフェースはgsrp-directlinkになっており、gsrpの切り替えが<code>no-neighbor-to-master direct-down</code>と設定されている為、障害時お互いがお互いに障害が起きたと判断して２台ともマスター状態で動いているためブロードキャストストームが起きた為パケットが正常に飛ばなくなるということです。<br />
またringプロトコルのヘルスチェックの送信間隔時間及び保護時間が間違っている為</p>
<h1>解答例</h1>
<p>ALA-B,ALA-Cをどちらかのgsrpの設定を<code>no-neighbor-to-master direct-down</code>と設定しgsrpをリスタートさせることで片方がバックアップとなりパケットを流さなくなります。<br />
これによってpingが正常に飛ぶようになります。<br />
ALA-B or ALA-C</p>
<pre class="brush: plain; title: ; title: ; notranslate" title=""><code>ena
conf t
gsrp 1
no-neighbor-to-master manual
exit
exit
restart gsrp</code></pre>
<p>またリングプロトコルのヘルスチェックの値に不備がある為これもパケットがおかしくなるという言及、及び設定変更<br />
ALA-A</p>
<pre class="brush: plain; title: ; title: ; notranslate" title=""><code>enable
conf ter
axrp 1
health-check interval 500
health-check holdtime 1600</code></pre>
<h1>採点基準</h1>
<p>pingが届くだけならgsrpの設定のみで済むので以下の配点となっています<br />
1. gsrpの挙動への言及とgsrpの設定変更をしpingが正常に飛ぶ　→ 基準点<br />
2. gsrpの解答をした上でaxrpのヘルスチェックの値に不備があることへの言及及び設定変更　→ 満点</p>
<h1>講評</h1>
<p>先に講評から<br />
１５チーム中5チームからの解答があり４チームが基準点を突破しそのうち１チームが満点でした。<br />
また満点のチームは外部のドキュメントを引用して何が起きているかの言及、また設定変更の手順を１つずつ丁寧に説明せれており芸術点も追加されています。<br />
さて学生のみなさんはRS232cを使うネットワーク機器を扱ったことはありますでしょうか？<br />
初めて見る学生さんは「なんだこのコンソールポートの口は？」と驚いたかもしれません<br />
最近では比較的rj45を使う機器しか見ないと思いますが、ベンダーによってはちらちらと出しているところを私は見ます。<br />
世間のネットワーク機器はcisco以外にもあらゆるベンダーで構成されています。<br />
そして一度も触ったことがないのに突如上司から「ネットにドキュメントがあるから読んでやって」というのも大人の世界ではあるかもしれません（私のバイト先ではありました。）<br />
今回出したalalaxaはコマンド体系がシスコライクなので学生でもcisco機器を勉強していれば、そこまで扱うのにはそこまで難しくないと思われます。<br />
今回cisco以外の機器を触って「あ、おもしろいな」って思った学生のみなさんはこれを機にあらゆるのベンダーのネットワーク機器に触れてみるのもいいかもしれません。<br />
次回も&#8221;出来ればですが&#8221;cisco以外のネットワーク機器を使った問題を作ってみたいと考えていますので楽しみにしてください。（確実に出るという保証は無いorz）</p>
