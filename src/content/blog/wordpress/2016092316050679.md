---
title: "ICTSC6 全問題の解説"
description: "ICTSC6 全問題の解説"
tags: [ICTSC6]
pubDate: 2016-09-23T16:05:18
slug: "2016/09/23/ICTSC6 全問題の解説"
draft: false
renderer: "html"
sticky: false
---

<p>こんにちは! ICTSC6 運営委員の田中京介です。<br />
第6回 ICTトラブルシューティングコンテストの最終日から早1ヶ月となってしまいました。<br />
今回は前回の反省を踏まえ、大会終了後すぐに問題解説を公開するとお伝えしていたにも関わらず、このように日が開いてしまい申し訳ありません。</p>
<p>今回は全15問の問題が公開され、大別するとネットワーク系の問題が7問、サーバー系の問題が8問ありました。これは前回と似た傾向であり、サーバー系の問題の出題が多かったです。</p>
<p>また、出題時間で見てみると、1日目は6問、2日目は9問が出題されました。<br />
特に、2日目の午後は同時に6問が出題されたこともあり、過去のICTSCでも例を見ないような、慌ただしい時間になったのではないでしょうか。</p>
<p>ICTSC6に参加された方には問題を振り返って頂き、そして次回参加される方には今後の糧として頂ければと思い、今回も全問題の解説を公開いたします。</p>
<p>※問題文については、当日に補足、修正が行われた部分があります。しかし、現時点では運営委員もコンテストサイトへアクセス出来ない状況にあるため、後日最新のデータを得られしだい、更新を行う予定です。</p>
<p>それでは、また次回の ICTトラブルシューティングコンテストでお会いしましょう!</p>
<p>(2016/9/24 追記: 問題5 および 問題15 の解説が誤っていたため訂正いたしました。皆様の混乱を招いてしまい、申し訳ありませんでした。)</p>
<h2>問題1 「ルーターの設定がわかりません」</h2>
<p>出題時間: 1日目午前, 問題技術: VPN, 満点: 30点</p>
<h3>問題文</h3>
<p>あなたは、とある会社のネットワークを管理を担当している。今回、本社と支社をVPNで接続することになった。その際出来る限り費用を抑えるため、支店側は仮想ルーターを使用することになった。</p>
<blockquote><p>「VPNのパラメーターってシスコのデフォルトだよね」<br />
「そうだね」</p></blockquote>
<p>2人で作業を行っていたのだが、もう一人が「ルーターの設定は終わったよ」と言って別の仕事に出かけてしまった。しかし、VPNが張れていないようなので、設定を確認しようとしたところ画面に何も表示されない。</p>
<p>現在の状況は以下の通りである。</p>
<ul>
<li>ルーターにコンソール接続しても何も表示されない</li>
<li>IPSecSAがアクティブになっていない</li>
</ul>
<p>標準設定でコンソールを接続すれば、通信ができるようにして欲しい。<br />
なぜVPN接続できないのか原因を確認し、VPN接続できるようにして欲しい。<br />
これらのトラブルの原因を詳しく説明して欲しい。</p>
<h3>トポロジ図</h3>
<p><img decoding="async" loading="lazy" class="alignnone wp-image-692" src="/images/wp/2016/09/problem-01-300x133.png.webp" alt="問題01 トポロジ図" width="512" height="227" /></p>
<h3>採点基準</h3>
<ul>
<li>DHのグループを合わせている</li>
<li>ボーレートを9600(デフォルト値)と異なっていたことに言及している</li>
<li>Ciscoルータ Show crypto isakmp sa で相手が見えている</li>
<li>vyOS show vpn ipsec sa で相手が見えている</li>
<li>インターフェースに暗号マップを適用していないことに気づいている</li>
<li>アクセスリストが不適切であったことに気づいている</li>
</ul>
<h3>解説</h3>
<ul>
<li>まず、ターミナルにうまく表示されない問題ですが、これはルーターのボーレートとターミナルのボーレートの不一致によって発生します。</li>
<li>ボーレートとは、信号の伝送速度のことであり、これが一致していない場合正しく通信が行われず、画面に何も表示されなかったり、文字化けが発生したりします。</li>
<li>IPSecSAがアクティブになっていない問題は、3つの理由でトラブルが発生しています。DHグループの不一致、暗号マップをインターフェースに適用していない、VPN対象となるパケットのアクセスリストがワイルドカードマスクで指定しなければならないところをサブネットマスクで指定しているの3つです。</li>
</ul>
<ul>
<li>DHグループによって、鍵交換のためのアルゴリズムで使われる鍵の生成情報が異なるので、一致している必要があります。</li>
<li>暗号化マップとは、トランスフォームセット、暗号化対象のACL、IPsecピアのアドレスを定義したものです。これを、インターフェースに適用する必要があります。</li>
<li>暗号化対象のACLの設定が不適切なため、正しく対象パケットを指定出来ていないので、VPNがうまく張れません。これらの設定を正しく設定しなおすことによりトラブルは解決します。</li>
</ul>
<h2>問題2 「繋がらなくなりました」</h2>
<p>出題時間: 1日目午前, 問題技術: VLAN ID, 満点: 10点</p>
<h3>問題文</h3>
<p>あなたはとあるビルのネットワーク管理を任されている。</p>
<p>ある日そのビルの点検で停電が発生した。点検後、ある部署でインターネットに繋がらなくなったという連絡を受けた。</p>
<ul>
<li>部署アドレス(10.100+x.5.0/24)【xはチーム番号】</li>
</ul>
<p>部署アドレスで正しく繋がるようにして欲しい。</p>
<p>その後、設定を変更した箇所とその理由を詳しく説明して欲しい。</p>
<h3>トポロジ図</h3>
<p><img decoding="async" loading="lazy" class="alignnone wp-image-693" src="/images/wp/2016/09/problem-02-300x185.png.webp" alt="問題02 トポロジ図" width="513" height="317" /></p>
<h3>採点基準</h3>
<ul>
<li>部署アドレスで通信ができる</li>
<li>トラブルの原因を詳しく説明できている</li>
<li>スイッチのインターフェースに正しいVLANを適用している</li>
<li>ルーターのサブインターフェースに正しいアドレスとカプセル化タイプを指定している</li>
</ul>
<h3>解説</h3>
<ul>
<li>この問題のトラブル発生原因は大きく分けて２つあります。</li>
<li>1つ目が、スイッチのインターフェースにVLANが適用されていないという点。２つ目が、ルーターのサブインターフェースの設定がされていない点です。
<ul>
<li>スイッチにVLANを定義したとしても、スイッチのインターフェースにVLANが適用されていないと、VLANは利用できません。</li>
<li>ルーターのサブインターフェースにトランクポートで送られてくるパケットの情報を書かないと、それぞれのVLANとうまく通信出来ません。</li>
</ul>
</li>
<li>VLANはネットワークを考える上で必須技術となっていると思います。そのVLAN関連のトラブルシューティングを体験して頂きたいと考え問題出題をしました。</li>
<li>また、今回の停電後にトラブルが発生したというのは、設定を行ったあと設定を保存していなかったために設定が消えてしまい、発生したトラブルという想定で出題しました。設定を変更したら、その設定を保存する大切さも考えて頂きたいという思いからこのような設定にしました。</li>
</ul>
<h2>問題3 「移行したアプリケーションが動かない!」</h2>
<p>出題時間: 1日目, 問題技術: MySQL sql_mode, 満点: 40点</p>
<h3>問題文</h3>
<p>担当者のAさんは,あるアプリケーションが動いているサーバをリプレースする作業を命じられました.</p>
<p>そこで,新しいサーバをセットアップしました.その際,以前使用していたディストリビューションのバージョンが古くなっていたため,新しいサーバでは,最新バージョンのディストリビューションを採用することにしました.</p>
<p>ところが,新しいサーバでアプリケーションを動かしてみたところ,エラーが発生して動作しません.</p>
<p>Aさんに代わって,原因の調査と復旧手段を報告して下さい.</p>
<h3>トポロジ図</h3>
<p><img decoding="async" loading="lazy" class="alignnone wp-image-694" src="/images/wp/2016/09/problem-03-300x225.jpg.webp" alt="問題03 トポロジ図" width="512" height="384" /></p>
<h3>採点基準</h3>
<ul>
<li>Webサービスがきちんと動いているかどうか</li>
<li>なぜWebサービスがきちんと動かなかったら,きちんと原因の特定ができているか.
<ul>
<li>(特に,あるクエリが昔のバージョンで動作し,今のバージョンで動作しない理由についてきちんと言及できているか.)</li>
</ul>
</li>
</ul>
<h3>解説</h3>
<p>MySQL5.7.8 からは デフォルトの sql_mode が</p>
<pre class="brush: plain; title: ; notranslate" title="">ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,
      ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION
    </pre>
<p>になっている</p>
<ul>
<li>これにより,select a, count(*) from hoge; のような group by なしの クエリが落ちてしまう.</li>
<li>ONLY_FULL_GROUP_BYを外せばOK</li>
</ul>
<h2>問題4 「アップローダが動きません!」</h2>
<p>出題時間: 2日目午前, 問題技術: inode, 満点: 30点</p>
<h3>問題文</h3>
<p>とある喫茶店では、「らびっとほーす」というサービスをWebにて提供している。</p>
<p>このサービスはログイン不要で自由にファイルをアップロード/ダウンロードできるサービスです。</p>
<p>このサービスは今まで順調に稼働していたが、ある日を境に突然アップロードができなくなってしまった。</p>
<p>まだ調査が進んでおらず、原因が分かっていないので。原因究明を行ってほしい。また、可能であれば対処を行ってほしい。</p>
<p>ただ、このサービスはある程度のユーザーがおり、アップロードができない状態でもダウンロードを行うユーザーはいるため、できる限り復旧時にダウンタイムを設定しないこと。</p>
<p>また、喫茶店の一人娘の自称姉がよくわからないままに立てたサービスであるため、サーバーのログイン情報以外のことは分かっていません。</p>
<p>このサービスは人気であるため、ダウンタイムが発生すると減点される可能があります。</p>
<h3>トポロジ図</h3>
<p><img decoding="async" loading="lazy" class="alignnone wp-image-695" src="/images/wp/2016/09/problem-04-300x217.png.webp" alt="問題04 トポロジ図" width="512" height="371" /></p>
<h3>採点基準</h3>
<ul>
<li>inode 不足に気が付く</li>
<li>ディスクを新規に作成して問題を解決し、アップロードを可能にする (満点)</li>
<li>減点: ダウンタイムの長さに応じて / ファイルが消えている場合など</li>
</ul>
<h3>解説</h3>
<ul>
<li>アップローダプログラムのログや、 <code>touch</code> 等でファイルシステムに新規にファイルを作成できないことから inode 不足を推測してほしい</li>
<li>近年のWebアプリケーションでは非常に高い可用性が求められている。今回の問題についても、既にアップロードができないという機能不全が生じているが、それでもダウンロードの要求は多くあったため、その要求を止めないことがまずサービスの継続のためには必要であると認識してほしい。
<ul>
<li>その上で、ダウンタイムを減らして復旧を行うための方法を考えて実行してほしい</li>
</ul>
</li>
<li>今回は、3秒間隔で GET / のステータスコードが 200 OK となるかのみを見る SLAチェッカが動作していました。
<ul>
<li>時間があればアップロードやダウンロードなどを行うSLAを用意したかったのですが間に合わず……</li>
</ul>
</li>
<li>また、ディスクには意図的に空き領域を設けてあり、新規のパーティションを作成することができるようになっていました。
<ul>
<li>これ用いてパーティションを作り、手動マイグレーションを実行することが今回の意図した解答でした。</li>
</ul>
</li>
</ul>
<h2>問題5 「引継ぎ失敗しました」</h2>
<p>出題時間: 1日目午後, 問題技術: Aux, 満点: 30点</p>
<h3>問題文</h3>
<p>先日、弊社で長年ネットワーク機器の設定を行っていたインフラエンジニアがやめてしまった。<br />
今回あなたには彼を引き継いでネットワーク機器の設定を行ってほしい。<br />
変更する機器はルータAで、最終的にルータBと疎通が取れるようにしてほしい。<br />
ただ、作業に伴い以下の事を注意してほしい。</p>
<p>&#8212;&#8212;注意事項&#8212;&#8212;</p>
<ul>
<li>引き継ぎ内容に漏れがあったためルータAの設定内容や一部認証情報は分からない。</li>
<li>ネットワークを止めるわけにはいかないので電源は落とさないように。</li>
</ul>
<p>&#8212;&#8212;ここまで&#8212;&#8212;</p>
<p>作業が終わったら確認のため、ルータAのコンフィグと作業内容を全て報告するように。<br />
尚、足りない情報はルータBの設定から得るか、自ら探して欲しい。</p>
<p>ルータA &#8220;イネーブル&#8221; パスワード:*******<br />
ルータB &#8220;イネーブル&#8221; パスワード:*******</p>
<h3>トポロジ図</h3>
<p><img decoding="async" loading="lazy" class="alignnone wp-image-726" src="/images/wp/2016/09/f92e17652363053a480a16543dce012d.png.webp" alt="problem-05" width="501" height="213" /></p>
<p>&nbsp;</p>
<h3>想定解</h3>
<ul>
<li>コンソールポートからルータAに未知のユーザ名とパスワードがかかっている事を知る<br />
(telnetはdisableにしておく)</li>
<li>電源を落としてはいけないのでAUXポートからコンソール接続する</li>
<li>show runから、未知のユーザ名が ictsc6 だと気付く</li>
<li>以下のコマンドを用い、任意のユーザ名とパスワードに変更する
<ul>
<li><code>no username ictsc6 password</code></li>
<li><code>username 任意 password 任意</code></li>
</ul>
</li>
</ul>
<p><strong>&lt;ここから 順不同&gt;</strong></p>
<ul>
<li><code>show ip int</code>等のコマンド、もしくはping等からシリアルインタフェースが <code>admin shut</code> 状態にあることに気付く</li>
<li>シリアルインタフェースを<code>no shutdown</code>する
<ul>
<li>(shutしてる理由は、本来変更対象ではないルータBを操作し、直ってしまうケースを回避するため)</li>
<li>(ACLがあるのでルータBからの変更だけでは繋がらないが、念のため)</li>
</ul>
</li>
<li>ルータA側のACLで、ルータBからの応答が暗黙のDenyになってることに気付く</li>
<li>暗黙のDenyにならないよう以下の変更を加える
<ul>
<li>今ある設定を消すのはよろしくないので、ACLを消した場合は減点<br />
(元通り再設計した場合は不問)</li>
<li><code>access-list 100 permit icmp ルータB ipaddress 0.0.0.0 ルータA ipaddress 0.0.0.0 echo-reply</code></li>
</ul>
</li>
</ul>
<p>シリアルインタフェースのカプセル化がルータAとルータBで違うことに気付く</p>
<ul>
<li>ルータAの設定を以下のように変更し、ルータBのカプセル化に合わせる
<ul>
<li>あくまでも変更するのはルータAなので、ルータBを変更した場合は減点</li>
<li><code>int s0/0/0</code></li>
<li><code>encapsulation ppp</code></li>
</ul>
</li>
</ul>
<p><strong>&lt;ここまで 順不同&gt;</strong></p>
<ul>
<li>以上の設定を終え、ルータAからルータBへ疎通が取れることを確認する</li>
<li>ルータAのコンフィグと全ての作業内容を報告し、終了</li>
</ul>
<h3>採点基準</h3>
<ul>
<li>AUXポートから入った事とユーザー+パスワードを変更するコマンドの記述があれば加点 (+?点)</li>
<li>ACLによって暗黙のDenyになっていた事と適切なACLコマンドの記述があれば加点 (+?点)</li>
<li>シリアルインタフェースのカプセル化が異なっていた事とカプセル化を変更するコマンドの記述があれば加点 (+?点)</li>
<li>シリアルインタフェースがadmin shut状態にあった事とその状態から回復させるコマンドの記述があれば加点 (+?点)
<ul>
<li>気付きだけでコマンドの記述が無い場合、減点 (-?点 x 該当数)</li>
<li>暗黙のDenyを回避する方法がACLの全削除だった場合減点 (-?点)</li>
<li>カプセル化変更をルータBに行った場合減点 (-?点)</li>
<li>公平を期す為、電源を落としリカバリした場合、得点なし もしくは 獲得した得点の半分を減点する
<ul>
<li>再起動はpingによる監視およびwrしてないホスト名によって判断する。<br />
(pingによる監視にしたのはサービスへの到達性が重要になると考えたため)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>解説</h3>
<p>今回の問題では、ルータBと疎通を取るためにルータAのインタフェースに変更を加える作業が大部分となっています。<br />
内容として、設定の違いまたはミスによって通信ができないトラブルを再現しました。<br />
そして、今回のように複数個所にトラブルがある場合、running-configやshowコマンドから異常個所を特定する力も必要になってくる為、あえて問題点を複数箇所用意しました。</p>
<p>しかし問題の主旨は別にあり、電源を切らずルータAに掛かっているパスワードを突破する事が重要な要素となっています。<br />
問題文にもあるように、電源を落とすわけにはいかない事からROMモニタからのパスワードリカバリを行うことは出来ません。<br />
また、今回の場合一部認証情報が欠落しており、sshからの接続も出来ません。<br />
それを打開策の一つとして、AUXポートからコンソールケーブルを挿し、パスワードリカバリする方法がある為<br />
今回の問題ではその方法を用いて突破できる形にしました。</p>
<p>実作業でも「電源を落とさない」「疎通性は確保したまま」で変更しなければいけない場面はとても多いはずです。<br />
この問題を通して、その考え方を理解していただければと思います。</p>
<h2>問題6 「VMがネットワークにつながらない!」</h2>
<p>出題時間: 1日目午後, 問題技術: MACアドレス衝突, 満点: 40点</p>
<h3>問題文</h3>
<p>ある日、VMに対して操作を行ったら2台のVMがネットワークに対しておかしな挙動をするようになりました。</p>
<p>担当者のAさんは調査を行いましたが何が何だかでお手上げです。</p>
<p>引きこもってしまったAさんに代わって情報を集めるところから始めて、原因を報告してください。</p>
<h3>トポロジ図</h3>
<p><img decoding="async" loading="lazy" class="alignnone wp-image-697" src="/images/wp/2016/09/problem-06-300x225.jpg.webp" alt="問題06 トポロジ図" width="512" height="384" /></p>
<h3>採点基準</h3>
<ul>
<li>MACアドレスの重複に気づくこと (満点)</li>
</ul>
<h3>解説</h3>
<ul>
<li>httpのロードバランスのためにVMを愚直にコピーしてしまった想定</li>
<li><a href="https://orebibou.com/2014/01/mac%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9%E9%87%8D%E8%A4%87%E6%99%82%E3%81%AE%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%E3%81%AE%E5%8B%95%E3%81%8D/">このサイトみたいな動き</a></li>
</ul>
<h2>問題7 「自動マウントをしてくれない!」</h2>
<p>出題時間: 1日目午後, 問題技術: pam_mount, 満点: 30点</p>
<h3>問題文</h3>
<p>ある日、普段windowsの各ユーザーに対して割り当てているsamba共有フォルダをubuntuで同様に割り当てることになりました。</p>
<p>各ユーザーの<code>~/private</code>というディレクトリに<code>\\file.example.local\private\%username%</code>という共有ファイルをマウントします。</p>
<p>上司から頼まれたAさんは<code>pam_mount</code>というパッケージを導入し、実現しようとしました。</p>
<p>ところが作業ユーザーでは<code>~/private</code>に期待通りのフォルダをマウントできていますが、書き込みができません。</p>
<p>失踪したAさんから仕事を引き継ぎ、正しく動作するように設定してください。</p>
<p>要件は以下の通りです。</p>
<ul>
<li>可能な限り<code>pam_mount</code>を使うこと</li>
<li>共有フォルダに対して読み書きの操作ができること</li>
<li>新規ユーザーで滞りなくマウントを完了し、読み書きの操作ができること</li>
</ul>
<h3>トポロジ図</h3>
<p><img decoding="async" loading="lazy" class="alignnone wp-image-698" src="/images/wp/2016/09/problem-07-300x225.jpg.webp" alt="問題07 トポロジ図" width="512" height="384" /></p>
<h3>採点基準</h3>
<ul>
<li>作業ユーザーからマウントした共有フォルダへ読み書きができること(6点)</li>
<li>新規ユーザーの<code>~/private</code>から共有フォルダへマウントできていること
<ul>
<li>書き込みが出来ること(12点)</li>
<li>読み込みができること(12点)</li>
</ul>
</li>
</ul>
<h3>解説</h3>
<ul>
<li>Sambaの<code>ro</code>フラグ
<ul>
<li>接続した共有ディレクトリが読み込み専用になる</li>
</ul>
</li>
<li><code>chattr +i</code>
<ul>
<li>inodeの編集禁止フラグを設定する</li>
<li>skelに用意することで新規ユーザーのマウント先がファイルになり、マウントできず、削除できず…という状況を作ることができる</li>
</ul>
</li>
</ul>
<h2>2日目</h2>
<h2>問題8 「社内ネットワークを設定して!」</h2>
<p>出題時間: 2日目午前, 問題技術: IPv6 / v4, 満点: 40点</p>
<h3>問題文</h3>
<p>昨日社内ネットワークのトラブルを解決するように頼まれたあなたは、上司に呼び出されこのようなことを言われました。<br />
「社内ネットワークをIPv6アドレスに変更しようという案があってね。その一環として社内ネットワークの一部をIPv6ネットワークに変更するんだけど、そのIPv6ネットワークからIPv4ネットワークに通信できるようにルータ(参加者に設定してもらうルータ)の設定お願い。」<br />
「とりあえず通信できればいいけど、できればルータを再設定しないでもいい設定をしてくれると嬉しいな。」<br />
「そうそう、僕の方で調べてたらNAT64というのがあったと思うよ。」<br />
「昨日起こったトラブルを解決してくれたなら、外に繋がるようになってるはずだから。」<br />
あなたは上司に言われたようにルータの設定を行い、設定したルータのコンフィグを提出してください。</p>
<h3>トポロジ図</h3>
<p><img decoding="async" loading="lazy" class="alignnone wp-image-699" src="/images/wp/2016/09/problem-08-300x231.jpg.webp" alt="問題08 トポロジ図" width="512" height="394" /></p>
<h3>採点基準</h3>
<ul>
<li>IPv6ネットワークからIPv4ネットワークに通信ができる(NAT-PTの設定ができている)</li>
<li>NAT-PTがダイナミックの設定になっている</li>
<li>NAT-PTがNAPTの設定になっている</li>
</ul>
<h3>解説</h3>
<ul>
<li>IPv6ネットワークからIPv4ネットワークには規格が異なるため、基本的には通信できません。そこで、様々なIPv6ネットワークとIPv4ネットワークの共存技術を知ってもらう目的で出題しました。</li>
<li>共存技術にはNAT-PT, NAT64, v4v6トンネリングなどいろいろありますが今回の場合ルータの機能の制約の関係でNAT-PT以外の設定はできません。</li>
<li>IPv6を用いた出題は初めてなため、参加者のIPv6の知識を調べる目的も兼ねて出題しました。</li>
</ul>
<h2>問題9 「レプリケーションが出来ない!」</h2>
<p>出題時間: 2日目午前, 問題技術: MySQL replication, 満点: 20点</p>
<h3>問題文</h3>
<p>とある企業にてWebサイトの構築を行う業務があった。Aさんはデータベース周りの設定を担当していたが、初めてのレプリケーション設定と慣れないMYSQLの為悪戦苦闘していた。</p>
<p>納期が迫る中、Aさんは私事でどうしても本国に帰らないと行けなくなってしまった。試行錯誤が垣間見えるconfigを元にレプリケーションの設定を完了して欲しい。</p>
<h3>トポロジ図</h3>
<p><img decoding="async" loading="lazy" class="alignnone wp-image-700" src="/images/wp/2016/09/problem-09-300x197.png.webp" alt="問題09 トポロジ図" width="512" height="336" /></p>
<h3>採点基準</h3>
<ul>
<li>レプリケーションが行えてる
<ul>
<li>予めサンプルDBを準備しておいて、マスターでの変更がレプリケーション側で反映されていることが確認できる.</li>
</ul>
</li>
</ul>
<h3>解説</h3>
<ul>
<li>mysqlのレプリケーションが上手く動作しない問題
<ul>
<li>/etc/my.cnfの設定ミス
<ul>
<li>server-id等</li>
</ul>
</li>
<li>mysql slave側の設定ミス
<ul>
<li>master_log_file</li>
<li>master_log_pos等</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2>問題10 「IPアドレスが振られない!」</h2>
<p>出題時間: 2日目午後, 問題技術: DHCP, 満点: 40点</p>
<h3>問題文</h3>
<p>某C社では,CloudStackを用いたインフラ業務を行っている.ある日,Debian 8とUbuntu 16のインスタンスを建てた時にDebian 8にだけIPv4アドレスが割り振られないトラブルが発生した.</p>
<p>インスタンスのオーケストレーションの為にも,DHCPを用いたIPv4アドレス等の自動設定は必要不可欠であり,大量のインスタンスに対して,手動でIPv4アドレス設定することは難しい.</p>
<p>C社は,このトラブルをあなたに解決してもらい,インスタンス起動時にDHCPによるIPv4アドレスリリースが正常に動作させるようにしたいと考えている.</p>
<p><strong><em>ただし,DHCPサーバやCloudStackホストマシンに対して調査・変更を加えることはできない.</em></strong></p>
<p>原因を特定し,この問題を解決してほしい.</p>
<h3>トポロジ図</h3>
<p><img decoding="async" loading="lazy" class="alignnone wp-image-701" src="/images/wp/2016/09/problem-10-300x217.png.webp" alt="問題10 トポロジ図" width="512" height="370" /></p>
<h3>採点基準</h3>
<ol>
<li>UDP Checksumが壊れている事を指摘しているか … 25%</li>
<li>Ubuntu 16ではUDP Checksumが壊れているのにDHCPを正常に処理していることを指摘しているか … 25%</li>
<li>実際に何らかの方法でDebian 8にDHCPを処理されられたか … 50%</li>
</ol>
<h3>解説</h3>
<p>KVM + linux-bridge 環境では,DHCPパケットのUDPのChecksumが破損する状況が発生する.<br />
これを解決する為に,それぞれのディストリビューションのdhclientにはパッチが当てられているが,Debianだけは9から適用される.</p>
<h2>問題11 「聞きたくても、聞こえない」</h2>
<p>出題時間: 2日目 (通し), 問題技術: IP Phone, 満点: 50点</p>
<h3>問題文</h3>
<p>あなたの会社では、先日待望のIP電話が導入されました。</p>
<p>IP Phone は業務に関係のないことにも使えるようです。</p>
<ul>
<li>社長(運営)との雑談のため</li>
</ul>
<p>そんな IP Phone ですが、どうやら先日社内インフラ部がセキュリティ上の理由でスイッチの設定を変更した結果、こちら(参加者)の声が社長に聞こえなくなってしまったようです。</p>
<p>インフラ部は非常に対応が悪く、問題があるといっても一向に聞き入れず、調査を行ってくれません。しかし、何か正当な理由があればスイッチの設定変更には応じてくれるみたいです。</p>
<ul>
<li>もしコアスイッチ等に問題があるのであれば、質問に <strong>設定変更依頼</strong> と題して変更したい内容とポートなどの情報を伝えて下さい。</li>
<li>社員とわいわい雑談できないためか、最近は社長もご機嫌斜めです。早めに解決してください!</li>
</ul>
<h3>トポロジ図</h3>
<p><img decoding="async" loading="lazy" class="alignnone wp-image-702" src="/images/wp/2016/09/problem-11-300x229.png.webp" alt="問題11 トポロジ図" width="512" height="390" /></p>
<h3>採点基準</h3>
<ul>
<li>音声の伝送に必要なポートがxxxxx/UDP であることをパケットキャプチャから読み取り報告する</li>
<li>運営が報告したポートを疎通する設定にした後、運営の番号へ通話を試行し通話ができることを確認する</li>
</ul>
<h3>解説</h3>
<ul>
<li>SIPプロトコルに関する出題は初めてであるため、難しいと考えられるが、ミラーポートが与えられているということから、パケットキャプチャを上手く活用し、必要な情報を推測してほしい</li>
<li>IP Phone は起動時に、DHCP → TFTPサーバ → SIPサーバ の順でアクセスを行い、自機のセットアップを行います
<ul>
<li>このとき、IP Phone が通話に用いる (音声データを伝送する) ポートはメディアポートと呼ばれ、通話の開始時 (INVITE リクエスト時) に待ち受けポートを SIPサーバへ伝えます。</li>
<li>実際にパケットキャプチャを行うと、そのポートに向かって RTP (Real-time Transport Protcol, UDP) で音声パケットが伝送されていることが分かります。</li>
</ul>
</li>
<li>今回は SIP プロトコルそのものが用いるポートである、 5060/UDP or TCP は塞がれていませんでした。
<ul>
<li>このため、通話のセッション自体は生成されるが、音声データだけが伝送されないという現象が生じます。</li>
</ul>
</li>
<li>メディアポートは TFTP サーバにおいてある各端末固有の xml ファイル内の startMediaPort, endMediaPort タグに書かれているレンジからランダムで選択されることになっています。
<ul>
<li>今回使用した機種 (CP-7960G, CP-7961G) では、xml ファイルのファイル名は SEP0123456789ab.cnf.xml というような形で、SEP{IP Phone のMACアドレス}.xml という形で TFTPサーバのルートに置かれています。</li>
<li>IP Phone のネットワークにアクセスすることができる参加者手元の配線は IP Phone へ繋がっている1本しかないため、これを一度引っこ抜き、PC に接続してアクセスする方法が作問者の意図した方法です。
<ul>
<li>当日は思わぬトラブル(?)があり、会場の AP から SIPサーバや TFTPサーバにアクセスすることもできました。</li>
</ul>
</li>
</ul>
</li>
<li>各チームには事前に生成した xml にて、100ポート分の mediaPort のレンジを指定しており、これを特定して中間経路にある L2SW の acl を変更してもらうことで通話が可能になります。
<ul>
<li>全てのポートの解放を要求することでも、通話は可能になりますが、セキュリティ上よろしくないという理由で減点しています。</li>
<li>また、パケットキャプチャから、特定の1つのポートについての acl 変更申請をされたチームもありました。上記の説明を見るとお分かりかとは思いますが、メディアポートは100ポートの中からランダムで選ばれるため、1ポートだけを開けても正答とはなりません。 (この場合、通話100回に1回の確率で声が通る不思議な電話が完成します)</li>
</ul>
</li>
</ul>
<h2>問題12 「調子が悪いんでしょうか?」</h2>
<p>出題時間: 2日目午後, 問題技術: PathMTU, 満点: 30点</p>
<p><a href="http://tsuchinoko.dmmlabs.com/?p=4389">「NTT西日本杯」第6回 ICTトラブルシューティングコンテスト　問題解説 “調子が悪いんでしょうか？” | ツチノコブログ</a> にて解説記事が公開されています。</p>
<h3>採点基準</h3>
<ul>
<li>報告書にmtuの設定が不適切とあれば加点</li>
<li>報告書にPathMTUDiscoveryまで拒否されていたとあれば加点</li>
</ul>
<h2>問題13 「本社のサーバーに繋がりません」</h2>
<p>出題時間: 2日目午後, 問題技術: RIP + OSPF, 満点: 10点</p>
<h3>問題文</h3>
<p>ある日、会社Aの支社は本社に対して専用回線をつなぐことになりました。</p>
<p>社内ネットワークのルーティングプロトコルに支社は OSPF を使用し、本社は RIPv2 を利用しています。</p>
<p>このネットワークが正しく動作するように設定してほしいと頼まれたあなたは、ルータ(892J)の設定を新入社員のBさんに任せる事にしました。</p>
<p>Bさんから設定が終わったとの報告を受けていたので、無事に必要な設定を終えたとあなたは判断していました。</p>
<p>しかし、その翌日に他の部署(10.100 + team_number.7.0/24 ネットワーク)の社員から本社のWebサーバー繋がらないという連絡が入ったのでBさんが設定したルータ(892J)の設定を修正することになりました。</p>
<p>そこで、修正したルータのrunning-configと他の部署から繋がらなかった原因を報告書にして提出してください。</p>
<p>本社Webサーバ : <a href="http://web.ictsc6.pkpk/">http://web.ictsc6.pkpk/</a></p>
<h3>トポロジ図</h3>
<p><img decoding="async" loading="lazy" class="alignnone wp-image-703" src="/images/wp/2016/09/problem-13-300x148.png.webp" alt="問題13 トポロジ図" width="512" height="252" /></p>
<h3>採点基準</h3>
<ul>
<li>報告書に再配送時のmetric設定が不適切とあれば加点(+?点)</li>
<li>本社のサーバーにIPaddress/24ネットワークからアクセスできれば加点(+?点)</li>
</ul>
<h3>解説</h3>
<ul>
<li>今回の問題では、参加者側からWebサーバに通信できない状態にありました。</li>
<li>その中で注目すべきは、RIPのHOP数制限とtracerouteの結果です。</li>
<li>この問題でWebサーバへtracerouteをしてみると、二つ目から*表示という結果になってしまいます。</li>
<li>その理由が、以下の再配送設定にあります。router rip<br />
redistribute ospf 1<br />
offset-list 0 in 16 インタフェース名</li>
<li>ospfで学習した経路をripに再配送する場合、この設定のままだとシードメトリック値が20となってしまいrip側では破棄されてしまいます。</li>
<li>また、offset-listでは、ripから得た経路情報のhop数に16加算し学習しています。</li>
<li>ripのHOP数制限は15ですので、経路情報が破棄されてしまい通信ができないという状態になっていました。</li>
<li>会社の環境や機材によってはOSPFではなくRIPを使用せざるおえない状況がでます。</li>
<li>この問題では、そういったRIPとOSPFを併用している環境において起こり得る正しく経路情報を配送できないトラブルを再現してみました。</li>
</ul>
<h2>問題14 「sshでサーバに接続できない!」</h2>
<p>出題時間: 2日目午後, 問題技術: ssh, 満点: 10点</p>
<h3>問題文</h3>
<p>とある会社のとあるチームではCloudStackを用いて仮想化基盤を運用している</p>
<p>新人研修を行うときは新しく研修用サーバを用意し踏み台サーバから公開鍵認証のみでサーバにアクセスする方式を採用している。</p>
<p>ある日上司が研修用サーバにいたずらをしかけられる。</p>
<ul>
<li>「研修用のサーバ、sshではいれなくしといたよ!がんばって～:innocent:」と満面の笑みで衝撃的な内容を言い放ち、さっそうと早退していきました。</li>
</ul>
<p>上司のいたずらをかいくぐり、公開鍵認証でssh接続できるようにしてほしい。</p>
<p>※幸いなことにweb consoleへのアクセス権は上司から貰っている</p>
<p>これまた上司のいたずらかweb consoleのキーボードレイアウトが<strong>USキーボード</strong>に設定されているようだ。</p>
<h3>トポロジ図</h3>
<p><img decoding="async" loading="lazy" class="alignnone wp-image-704" src="/images/wp/2016/09/problem-14-300x221.png.webp" alt="問題14 トポロジ図" width="512" height="378" /></p>
<h3>採点基準</h3>
<ol>
<li>実際に踏み台サーバからssh接続できる</li>
<li>原因となった設定を報告</li>
<li>修正点などがあればなおよい</li>
</ol>
<h3>解説</h3>
<ul>
<li>/etc/ssh/sshd_config のAuthorizedKeyFile のpath指定ミス</li>
<li>authorized_keysのnistp521が512になっている</li>
<li>chattr +i で/etc/ssh/sshd_configが書き込めない</li>
</ul>
<h2>問題15 「なんかwebページおかしい?」</h2>
<p>出題時間: 2日目午後, 問題技術: hsts, 満点: 20点</p>
<h3>問題文</h3>
<p>先日、社内にて外部向けホームページを作成した。</p>
<p>現在そのホームページを社内検証用Webサーバーにて公開したところ、うまく作成した通りにホームページが表示されない問題が発生した。</p>
<p>社内検証用のWebサーバーへのアクセス権と、 社内クライアント用VMのゲストユーザー操作権を与えるので、webサーバーをsshで操作し、CloudStackのwebコンソールからクライアント用VMを操作して障害の原因を調査し正常にwebページが表示されるように解決してほしい。</p>
<p>ただし、Webサーバーにもともとあるセキュリティ性は落としてはならない。</p>
<h3>トポロジ図</h3>
<p><img decoding="async" loading="lazy" class="alignnone wp-image-723" src="/images/wp/2016/09/9833eab6-4baa-11e6-9536-3a42e806d535-300x181.png.webp" alt="9833eab6-4baa-11e6-9536-3a42e806d535" width="446" height="269" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>採点基準</h3>
<ol>
<li>httpの外部参照をhttpsに変更できているか</li>
<li>レイアウトが変更されていないか</li>
<li>HSTS設定を変更していないか</li>
</ol>
<h3>解説</h3>
<ul>
<li>HSTSによりhttpsを強制しているため、httpで外部参照しているWEBフォントやjsファイルは信頼されないコンテンツとしてwebブラウザが弾くことが原因。</li>
<li>外部参照をhttpからhttpsに変更することで問題が解決される。</li>
</ul>
