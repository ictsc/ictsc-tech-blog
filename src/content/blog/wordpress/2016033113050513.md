---
title: "問題解説: Webページが見られない"
description: "問題解説: Webページが見られない"
tags: [ICTSC5,サーバー関連,問題解説]
pubDate: 2016-03-31T13:05:28
slug: "2016/03/31/問題解説: Webページが見られない"
draft: false
renderer: "html"
sticky: false
---

<p>はじめまして。本問題の雑用係をしています工学院大学の福田夏樹と申します。</p>
<p>問題解説のブログを書いて欲しいというリーダからのお願いを受けて、締め切りギリギリになって本記事を書き始めました。</p>
<p>拙文ではありますが、問題解説をさせていただきます。</p>
<h1>問題概要 : Webページが見られない</h1>
<h2>問題文</h2>
<p>本日、我が&#8217;boku-tech company&#8217;のカスタマーサービスセンターから、<br />
「Webページに接続できない。接続できても重い」<br />
という苦情が寄せられていることが判明した。<br />
また、数日前に新しいサーバが納品され、社内のネットワークのどこかに接続されたようだ。<br />
しかし、その作業は外部の業者が行っており、ネットワークや納入されたサーバの状況を社内で知っている人はいない。</p>
<p>今回に限り、優秀な技術者と聞く君たちに該当のサーバ類の一部の操作権を付与する。<br />
現状を調査した上でその解決をし、その原因と解決方法を報告してほしい。<br />
なお、サーバ上では各種サービスが動いているらしいが、それらや他のサーバを完全停止することはできない。</p>
<p>我が社が作業を外注した時の資料を入手することができた。<br />
その資料には下記の制約が書かれていた。<br />
この制約を満たすように設定・定義してもらいたい。この制約に反しないかぎり、他の設定を変更しても構わない。</p>
<ul>
<li>webサーバーのリソースをsnmpプロトコルを用いてサービスサーバにログが残させる事</li>
<li>Service Server に対して、ドメイン “service.rabbit” のAレコードが引けること</li>
<li>webサーバに含まれるコンテツの再生が出来る事</li>
</ul>
<p>君たちが操作できるサーバは下記のとおりである</p>
<h4>Service Server</h4>
<ul>
<li>IP : 10.X.8.66</li>
<li>User: admin</li>
<li>Password : チームごとに与えられているもの</li>
</ul>
<h4>Web Server</h4>
<ul>
<li>IP: 10.X.8.2</li>
<li>User: admin</li>
<li>Password : チームごとに与えられているもの</li>
</ul>
<p>Router<br />
&#8211; IP : 10.X.8.192<br />
&#8211; User: vyos<br />
&#8211; Password : チームごとに与えられているもの</p>
<h1>トラブルの原因</h1>
<p>まずは、トラブルを起こしていたトポロジ図は下記のようになります。</p>
<p><img decoding="async" src="/images/wp/2016/03/topology.png.webp" alt="トポロジ図" /></p>
<p>今回の問題でトラブルとして使用したものは次のものです</p>
<ul>
<li>SNMP のリクエストによるCPU枯渇</li>
<li>Ping パケットの大量送信による帯域枯渇</li>
<li>SYN Flood によるセッション数枯渇</li>
</ul>
<p>その他、仕込んでいたトラブルも有りましたが、そのあたりは ICTSC5の<a href="https://speakerdeck.com/kayotozaki43/carpet-bombing-by-multiple-attack">1日目にあったLTの資料</a>をご参考にください。</p>
<h1>解決方法</h1>
<p>上記のトラブルの原因を一つ一つ解決していけば解決できます。</p>
<p>代表的な解決方法を上げると、以下のようになります。</p>
<h3>SNMP</h3>
<p>SNMPのコミュニティ名をデフォルトである <code>public</code> から任意のものに変更する。</p>
<p>今回の問題では、<code>/etc/snmp/snmpd.conf</code> に記述されている <code>public</code> という文字列を任意のものに書き換えることができれば解決になります。</p>
<h4>Ping</h4>
<p>VyOS にて、ICMPのフィルタリングをする。</p>
<p>フィルタリングの方法は複数あるので、コマンドは省略しますが、検索をかけるといくつか出てきます。</p>
<h4>SYN</h4>
<p>サーバOSのSynCookieを有効化する。</p>
<p>今回の問題の場合は、次のコマンドを入力すると解決になります。</p>
<p>&nbsp;</p>
<p><code>sysctl -w net.ipv4.tcp_syncookie=1</code></p>
<p>&nbsp;</p>
<p>などあります。</p>
<p>その他の解説などは、本問題担当であった法政大学の伊東氏が<a href="http://www.slideshare.net/palloc/ss-58853721">LT資料</a>や<a href="http://palloc.hateblo.jp/entry/2016/02/29/224107">ブログ</a>を書いているので、ご参考にしてください。</p>
<h1>出題意図</h1>
<p>近年世界的に起きているDoS攻撃の基本的な対策方法を日本の若きエンジニア達に知ってほしいため、<br />
また、前回大会において出題されたセキュリティ攻撃に関する問題においての解答率が出題者の想定よりも低かったため、本大会では攻撃の種類を変えて、再度出題しました。</p>
<h1>採点基準</h1>
<p>問題文に記述されている</p>
<blockquote>
<ul>
<li>webサーバーのリソースをsnmpプロトコルを用いてサービスサーバにログが残させる事</li>
<li>Service Server に対して、ドメイン “service.rabbit” のAレコードが引けること</li>
<li>webサーバに含まれるコンテツの再生が出来る事</li>
</ul>
</blockquote>
<p>を満たす様な設定ができているかを判断しています。</p>
<p>簡単に言うと、原因となっている攻撃がフィルタリング等できていれば得点が入る様にしました。</p>
<h1>最後に</h1>
<p>問題を解いたみなさんは、解けた時はとても嬉しいと思いますが、<br />
実は出題者側も、みなさんが解いてくれた時は嬉しかったりします。</p>
<p>本問題は一般的にはDDoS攻撃という部類になり、その攻撃手法は今回のもののみではなく多岐に渡ります。<br />
更に、その対処も難しいものとなっています。</p>
<p>セキュリティ的な脆弱性も、ヒューマンエラーによるものでも、ソフトウェアにある潜在的なものでも、トラブルの元となるということも知っていただければ幸いです。</p>
<p>では、又の機会にお会いしましょう。</p>
