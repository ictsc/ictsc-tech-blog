---
title: "問題解説：WEBサーバーに繋がりません"
description: "問題解説：WEBサーバーに繋がりません"
tags: [ICTSC5,ネットワーク関連,問題解説]
pubDate: 2016-03-23T21:35:40
slug: "2016/03/23/問題解説：WEBサーバーに繋がりません"
draft: false
renderer: "html"
sticky: false
---

<p>みなさんこんにちは！大阪工業大学藪野好一です。<br />
ICTSC5が終了してからもうすぐ１ヶ月ですね。とても時間の経過が早いと感じるこの頃です。</p>
<p>前回は、<a href="https://blog.icttoracon.net/2016/02/01/make-webapp/">WEBアプリケーションを作ってみました</a>というタイトルでブログを書かせて頂きましたが、今回は大会1日目の午前に出題したWEBサーバーに繋がりませんという問題の解説をしたいと思います。</p>
<h1>問題文</h1>
<p>ある部署の追加に伴ってネットワークの改修を行った。しかし、改修後サーバーに繋がらなくなった。このトラブルの原因を特定し、正しく繋がるように設定を変更して欲しい。また、変更点と原因を詳しく説明して欲しい。</p>
<h1>トラブルの原因</h1>
<p>この問題は、WEBサーバーに繋がらないといっていますが、原因はサーバー側ではなく経路情報の交換が行われないというトラブルで、そのトラブルを解決してもらう問題でした。経路情報が正しく回っていない理由は２つあります。</p>
<p>１つ目は、MTUのサイズの不一致で、２つ目がアクセスリストの暗黙のdenyによるOSPFパケットの拒否でした。対向するインターフェイスのMTUサイズが一致しないと隣接関係を確立することが出来ないため、OSPFでの経路情報の交換が行えません。アクセスリストとは、通過するパケットの許可と拒否を設定することが出来るリストで、通過が許可されていないパケットは通過が暗黙的に拒否されます。今回最初に適用していたアクセスリストでは、OSPFの通過を許可する条件に一致しないため、OSPFパケットの通過が暗黙的に拒否されます。</p>
<p>この２つの理由によりOSPFによる経路交換が行われなくなりWEBサーバーに接続できない状態となっていました。</p>
<p><img decoding="async" loading="lazy" class=" wp-image-471 aligncenter" src="/images/wp/2016/03/yabuno_issue-300x84.png.webp" alt="yabuno_issue" width="521" height="146" /></p>
<p>まとめると次のようになります。</p>
<ul>
<li>MTU(Maximum Transmission Unit)
<ul>
<li>一度の転送で送れるデータの最大量</li>
<li>対向のインターフェイスのMTUのサイズが違うとOSPFの隣接関係が確立出来ない</li>
</ul>
</li>
<li>ACL(Access Control List)
<ul>
<li>通過するパケットの許可と拒否を設定することが出来るリスト</li>
<li>通過が許可されていないパケットは通過が暗黙的に拒否される</li>
</ul>
</li>
</ul>
<h1>解決方法</h1>
<p>今回のトラブルでは、OSPFによる経路情報の交換が行われていないため、OSPFにより正しく経路情報の交換が行われるように設定の変更を行う必要があります。そのために、対向ルーターのMTUサイズを一致させ、アクセスリストをOSPFが通過できるように書き換えます。これにより、OSPFによる経路情報の交換が行えるようになります。</p>
<p><img decoding="async" loading="lazy" class=" wp-image-472 aligncenter" src="/images/wp/2016/03/yabuno_answer-300x79.png.webp" alt="yabuno_answer" width="523" height="138" /></p>
<p>さらに、次の２点の修正も行うことによりトラブルの発生を抑制したり、トラブルシューティングを容易にすることが出来ます。</p>
<p>１つ目がMSSの調整です。MSSとは、TCPで受信可能なヘッダを除いたデータサイズです。MTUサイズがイーサネットの標準サイズである1500から変更されている場合はMSSサイズも設定することが推奨されています。今回最初に設定されていたMTUサイズは1360だったので、TCPヘッダ(20byte)とIPヘッダ(20byte)の合わせて40byteを引いた1320をMSSサイズとして設定します。</p>
<p>２つ目は、アクセスリストで暗黙的に通過が拒否されているicmp のunreachableパケットの通過を許可する設定への変更である。このicmp unreachableパケットの通過が拒否されると、宛先に届けられなかったという情報が正常に帰って来ないためトラブルの原因となります。そのため、icmpのunreachableも通過を許可するようにアクセスリストを書き換えることが望ましいと考えます。</p>
<h1>出題意図</h1>
<p>普段は当たり前のように経路交換を行っているルーティングプロトコルがうまく動作しない場合の例とそれによって起こるトラブルを知って欲しいという思いから問題を出題しました。</p>
<h1>最後に</h1>
<p>１問目のインターネットに繋がりません問題と一緒に出題したため、問題の難易度が高くなってしまったようで、正解率はとても低かったです。<br />
もし、OSPFが回っていないというトラブルに遭遇した際にこの問題の事を思い出していただければ幸いです。</p>
<p>今回初めてトラブルシューティングコンテストに関わらせていただきましたが、多くの経験をさせて頂きました。この場をお借りしてお礼申し上げます。実行委員のみなさま、運営委員のみなさま、参加者のみなさま本当にありがとうございます。そしてお疲れさまでした。</p>
